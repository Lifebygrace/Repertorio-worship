<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Repertorio Worship</title>
  <style>
    /* tu CSS aquÃ­ (igual que antes) */
  </style>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import {
      getFirestore, collection, onSnapshot, query, orderBy
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDahT6IuQwSYdpAMcPpAERpqVuobmqmVSQ",
      authDomain: "repertorioworship.firebaseapp.com",
      projectId: "repertorioworship",
      storageBucket: "repertorioworship.appspot.com",
      messagingSenderId: "493050453266",
      appId: "1:493050453266:web:cf07ce9fbb471122f167cb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    function escucharCanciones() {
      const contenedor = document.getElementById("lista-canciones");
      const q = query(collection(db, "canciones"), orderBy("titulo", "asc"));

      console.log("Inicializando listener de canciones...");
      onSnapshot(q,
        (snapshot) => {
          console.log("Snapshot recibido, nÃºmero de canciones: ", snapshot.size);
          contenedor.innerHTML = "";
          const search = document.getElementById("search").value.toLowerCase();

          snapshot.forEach((docSnap) => {
            const data = docSnap.data();
            console.log("Documento:", docSnap.id, data);
            if (!data.titulo.toLowerCase().includes(search)) return;

            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <h2>${data.titulo}</h2>
              <p>${data.acordes}</p>
              ${data.imagenes?.map(url => `<img src="${url}" alt="Acordes">`).join('') || ""}
              ${data.audio ? `<p><a href="${data.audio}" target="_blank">ðŸŽ§ Escuchar Audio</a></p>` : ""}
              ${data.youtube ? `<p><a href="${data.youtube}" target="_blank">â–¶ Ver en YouTube</a></p>` : ""}
            `;
            contenedor.appendChild(div);
          });
        },
        (error) => {
          console.error("Error al escuchar canciones:", error);
          const cont = document.getElementById("lista-canciones");
          cont.innerHTML = `<p style="color:red;">Error al cargar canciones: ${error.message}</p>`;
        }
      );
    }

    window.onload = () => {
      escucharCanciones();
      document.getElementById("search").addEventListener("input", escucharCanciones);
    };
  </script>
</head>
<body>
  <header>
    <h1>Repertorio Worship</h1>
  </header>
  <main>
    <input type="text" id="search" placeholder="Buscar canciones..." />
    <div id="lista-canciones">
      <p>Cargandoâ€¦</p>
    </div>
  </main>
</body>
</html>