<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Repertorio Worship</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; }
    header { background-color: #0d1b2a; color: white; padding: 1rem; text-align: center; }
    nav { background-color: #1b263b; display: flex; justify-content: center; gap: 1rem; padding: 0.5rem; }
    nav a { color: white; text-decoration: none; font-weight: bold; }
    nav a:hover { color: #ff6600; }
    .container { padding: 1.5rem; max-width: 900px; margin: auto; }
    input[type="text"], textarea, input[type="file"], select {
      width: 100%; padding: 0.75rem; font-size: 1rem; border: 2px solid #ff6600; border-radius: 5px;
      margin-top: 0.5rem; box-sizing: border-box;
    }
    button { background-color: #ff6600; color: white; border: none; padding: 0.75rem 1.5rem;
      font-size: 1rem; margin-top: 0.75rem; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #e65c00; }
    .song-list { list-style: none; padding: 0; }
    .song-list li { background-color: #e0e0e0; margin: 0.5rem 0; padding: 0.75rem; border-radius: 5px; cursor: pointer; }
    .song-list li:hover { background-color: #ffedcc; }
    .chords-section { background-color: #ffffff; padding: 1rem; border: 2px solid #ff6600; border-radius: 8px;
      margin-top: 2rem; display: none; }
    .add-section { margin-top: 2rem; }
    footer { background-color: #1b263b; color: white; text-align: center; padding: 1rem; margin-top: 3rem; }
    .logo { max-width: 200px; display: block; margin: 1rem auto; }
    .advanced-options { display: none; margin-top: 2rem; padding: 1rem; background-color: #fff5e6; border: 1px dashed #ff6600; }
    .youtube-link { margin-top: 1rem; display: block; color: #1b263b; font-weight: bold; }
  </style>
</head>
<body>
  <header>
    <h1>Repertorio Worship</h1>
  </header>
  <img src="logo.jpg" alt="Life By Grace Church" class="logo" />
  <nav>
    <a href="#buscar">Buscar</a>
    <a href="#acordes">Acordes</a>
    <a href="#agregar">Agregar</a>
  </nav>
  <div class="container">
    <section id="buscar">
      <h2>Buscar Canción</h2>
      <input type="text" id="search" placeholder="Escribe el nombre de una canción..." />
      <ul class="song-list" id="songList"></ul>
    </section>

    <section id="acordes" class="chords-section">
      <h2>Acordes de la canción</h2>
      <div id="chordsContent">Selecciona una canción para ver sus acordes.</div>
    </section>

    <section id="agregar" class="add-section">
      <h2>Agregar Nueva Canción</h2>
      <input type="text" id="newTitle" placeholder="Título de la canción" />
      <textarea id="newChords" placeholder="Acordes (opcional si hay imagen)" rows="3"></textarea>
      <input type="file" id="newImage" accept="image/*" />
      <input type="text" id="newYoutube" placeholder="Enlace de YouTube (opcional)" />
      <button onclick="addSong()">Agregar Canción</button>
    </section>

    <section>
      <button onclick="toggleAdvanced()">🔧 Herramientas administrativas</button>
      <div class="advanced-options" id="advancedOptions">
        <h3>🔍 Eliminar Canción Específica</h3>
        <select id="songToDelete"></select>
        <button onclick="deleteSong()">Eliminar Seleccionada</button>
      </div>
    </section>
  </div>
  <footer>© 2025 Repertorio Worship - Grupo de Música</footer>

  <script>
    const songList = document.getElementById('songList');
    const searchInput = document.getElementById('search');
    const chordsSection = document.querySelector('.chords-section');
    const chordsContent = document.getElementById('chordsContent');
    const imageInput = document.getElementById('newImage');
    const youtubeInput = document.getElementById('newYoutube');

    function getStoredSongs() {
      const stored = localStorage.getItem('songs');
      return stored ? JSON.parse(stored) : [];
    }

    function saveSongs(songs) {
      localStorage.setItem('songs', JSON.stringify(songs));
    }

    function renderSongs(songs) {
      songList.innerHTML = '';
      songs.forEach(song => {
        const li = document.createElement('li');
        li.textContent = song.title;
        songList.appendChild(li);
      });
    }

    function addSong() {
      const title = document.getElementById('newTitle').value.trim();
      const chords = document.getElementById('newChords').value.trim();
      const youtube = youtubeInput.value.trim();
      const file = imageInput.files[0];

      if (!title) {
        alert('Por favor, introduce el título de la canción.');
        return;
      }

      const reader = new FileReader();
      reader.onloadend = function () {
        const imageData = file ? reader.result : null;
        const newSong = { title, chords, youtube, imageData };
        const songs = getStoredSongs();
        songs.push(newSong);
        saveSongs(songs);
        renderSongs(songs);
        document.getElementById('newTitle').value = '';
        document.getElementById('newChords').value = '';
        imageInput.value = '';
        youtubeInput.value = '';
      };
      if (file) {
        reader.readAsDataURL(file);
      } else {
        reader.onloadend();
      }
    }

    searchInput.addEventListener('input', function () {
      const filter = this.value.toLowerCase();
      const items = songList.getElementsByTagName('li');
      for (let item of items) {
        const text = item.textContent.toLowerCase();
        item.style.display = text.includes(filter) ? '' : 'none';
      }
    });

    songList.addEventListener('click', function (e) {
      if (e.target.tagName === 'LI') {
        const songs = getStoredSongs();
        const song = songs.find(s => s.title === e.target.textContent);
        chordsContent.innerHTML = '';
        if (song.chords) {
          const chordsEl = document.createElement('p');
          chordsEl.textContent = song.chords;
          chordsContent.appendChild(chordsEl);
        }
        if (song.imageData) {
          const img = document.createElement('img');
          img.src = song.imageData;
          img.style.maxWidth = '100%';
          chordsContent.appendChild(img);
        }
        if (song.youtube) {
          const videoId = song.youtube.split("v=")[1]?.split("&")[0];
          if (videoId) {
            const iframe = document.createElement('iframe');
            iframe.src = `https://www.youtube.com/embed/${videoId}`;
            iframe.width = "100%";
            iframe.height = "315";
            iframe.frameBorder = "0";
            iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
            iframe.allowFullscreen = true;
            chordsContent.appendChild(iframe);
          }
          const link = document.createElement('a');
          link.href = song.youtube;
          link.textContent = "Ver en YouTube";
          link.className = "youtube-link";
          link.target = "_blank";
          chordsContent.appendChild(link);
        }
        chordsSection.style.display = 'block';
      }
    });

    function toggleAdvanced() {
      const section = document.getElementById('advancedOptions');
      section.style.display = section.style.display === 'none' ? 'block' : 'none';
      if (section.style.display === 'block') {
        fillDeleteDropdown();
      }
    }

    function fillDeleteDropdown() {
      const dropdown = document.getElementById('songToDelete');
      const songs = getStoredSongs();
      dropdown.innerHTML = '';
      songs.forEach((song, index) => {
        const opt = document.createElement('option');
        opt.value = index;
        opt.textContent = song.title;
        dropdown.appendChild(opt);
      });
    }

    function deleteSong() {
      const dropdown = document.getElementById('songToDelete');
      const index = dropdown.value;
      const songs = getStoredSongs();
      const confirmDelete = confirm(`¿Seguro que quieres borrar la canción "${songs[index].title}"?`);
      if (confirmDelete) {
        songs.splice(index, 1);
        saveSongs(songs);
        renderSongs(songs);
        chordsContent.innerHTML = 'Selecciona una canción para ver sus acordes.';
        chordsSection.style.display = 'none';
        fillDeleteDropdown();
        alert('Canción eliminada.');
      }
    }

    renderSongs(getStoredSongs());
  </script>
</body>
</html>
